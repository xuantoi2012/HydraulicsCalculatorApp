<Window
    x:Class="HydraulicsCalculatorApp.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxd="http://schemas.devexpress.com/winfx/2008/xaml/docking"
    xmlns:views="clr-namespace:HydraulicsCalculatorApp.Views"
    xmlns:inputPanels="clr-namespace:HydraulicsCalculatorApp.Views.InputPanels"
    Title="Hydraulics Calculator - Tính toán Thủy lực nhanh"
    Height="800" Width="1400"
    WindowStartupLocation="CenterScreen"
    WindowState="Maximized">

    <DockPanel>
        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top" Background="White">
            <MenuItem Header="File">
                <MenuItem Header="New" Click="NewButton_Click" InputGestureText="Ctrl+N">
                    <MenuItem.Icon>
                        <Image Source="{dx:DXImage Image=New_16x16.png}" Width="16" Height="16"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Save" Click="SaveButton_Click" InputGestureText="Ctrl+S">
                    <MenuItem.Icon>
                        <Image Source="{dx:DXImage Image=Save_16x16.png}" Width="16" Height="16"/>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Exit" Click="ExitButton_Click" InputGestureText="Alt+F4"/>
            </MenuItem>
            <MenuItem Header="Calculate">
                <MenuItem Header="Calculate Now" Click="CalculateButton_Click" InputGestureText="F5">
                    <MenuItem.Icon>
                        <Image Source="{dx:DXImage Image=Apply_16x16.png}" Width="16" Height="16"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Find y from Q" Click="FindYFromQButton_Click"/>
            </MenuItem>
            <MenuItem Header="View">
                <MenuItem Header="Circular Pipe" Click="CircularPipeButton_Click"/>
                <MenuItem Header="Box Culvert" Click="BoxCulvertButton_Click"/>
                <MenuItem Header="Trapezoidal Channel" Click="TrapezoidalButton_Click"/>
            </MenuItem>
            <MenuItem Header="Tools">
                <MenuItem Header="Street Inlet Design" Click="ShowInletDesignButton_Click"/>
            </MenuItem>
            <MenuItem Header="Help">
                <MenuItem Header="About" Click="AboutButton_Click"/>
            </MenuItem>
        </Menu>

        <!-- Tool Bar -->
        <ToolBarTray DockPanel.Dock="Top" Background="WhiteSmoke">
            <ToolBar>
                <Button Click="NewButton_Click" ToolTip="New">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{dx:DXImage Image=New_16x16.png}" Width="16" Height="16" Margin="0,0,3,0"/>
                        <TextBlock Text="New"/>
                    </StackPanel>
                </Button>
                <Button Click="CalculateButton_Click" ToolTip="Calculate (F5)">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{dx:DXImage Image=Apply_16x16.png}" Width="16" Height="16" Margin="0,0,3,0"/>
                        <TextBlock Text="Calculate" FontWeight="Bold"/>
                    </StackPanel>
                </Button>
                <Separator/>
                <Button Click="CircularPipeButton_Click" ToolTip="Circular Pipe">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{dx:DXImage Image=Circle_16x16.png}" Width="16" Height="16" Margin="0,0,3,0"/>
                        <TextBlock Text="Circular"/>
                    </StackPanel>
                </Button>
                <Button Click="BoxCulvertButton_Click" ToolTip="Box Culvert">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{dx:DXImage Image=BOSquare_16x16.png}" Width="16" Height="16" Margin="0,0,3,0"/>
                        <TextBlock Text="Box"/>
                    </StackPanel>
                </Button>
                <Button Click="TrapezoidalButton_Click" ToolTip="Trapezoidal">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{dx:DXImage Image=Polygon_16x16.png}" Width="16" Height="16" Margin="0,0,3,0"/>
                        <TextBlock Text="Trapezoidal"/>
                    </StackPanel>
                </Button>
                <Button Click="ShowInletDesignButton_Click" ToolTip="Street Inlet Design">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{dx:DXImage Image=WaterFlow_16x16.png}" Width="16" Height="16" Margin="0,0,3,0"/>
                        <TextBlock Text="Inlet Design"/>
                    </StackPanel>
                </Button>
            </ToolBar>
        </ToolBarTray>

        <!-- Status Bar -->
        <StatusBar DockPanel.Dock="Bottom">
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Status: " FontWeight="Bold"/>
                    <TextBlock x:Name="txtStatus" Text="Ready"/>
                </StackPanel>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Mode: "/>
                    <TextBlock x:Name="txtCurrentMode" Text="Circular Pipe" FontWeight="Bold" Foreground="DarkBlue"/>
                </StackPanel>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Text="© 2025 Hydraulics Calculator - by xuantoi2012"/>
            </StatusBarItem>
        </StatusBar>

        <!-- Main Content -->
        <dxd:DockLayoutManager>
            <dxd:LayoutGroup Orientation="Horizontal">
                <!-- Left Panel - Inputs -->
                <dxd:LayoutPanel Caption="⚙️ Inputs" 
                                ItemWidth="420"
                                AllowClose="False">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="10">
                            <!-- Type Selection -->
                            <GroupBox Header="Type Selection" Margin="0,0,0,10">
                                <StackPanel Margin="10">
                                    <RadioButton x:Name="rbCircular" 
                                               Content="🔵 Circular Pipe" 
                                               IsChecked="True" 
                                               Margin="0,5"
                                               Checked="CulvertTypeChanged"/>
                                    <RadioButton x:Name="rbBox" 
                                               Content="⬜ Box Culvert" 
                                               Margin="0,5"
                                               Checked="CulvertTypeChanged"/>
                                    <RadioButton x:Name="rbTrapezoidal" 
                                               Content="🔷 Trapezoidal" 
                                               Margin="0,5"
                                               Checked="CulvertTypeChanged"/>
                                </StackPanel>
                            </GroupBox>

                            <!-- Input Panels -->
                            <inputPanels:CircularPipeInputPanel x:Name="circularInputPanel" 
                                                               Visibility="Visible"/>
                            <inputPanels:BoxCulvertInputPanel x:Name="boxInputPanel" 
                                                             Visibility="Collapsed"/>
                            <inputPanels:TrapezoidalInputPanel x:Name="trapezoidalInputPanel" 
                                                              Visibility="Collapsed"/>

                            <!-- Reverse Calculate -->
                            <GroupBox Header="🔄 Find y from Q" Margin="0,0,0,10">
                                <StackPanel Margin="10">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Target Q:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <dxe:TextEdit x:Name="txtTargetQ" Width="120"/>
                                            <TextBlock Text="m³/s" VerticalAlignment="Center" Margin="5,0,0,0"/>
                                        </StackPanel>
                                    </Grid>
                                    <dx:SimpleButton Content="🔍 Find y" 
                                                   Height="35" Margin="0,10,0,0"
                                                   Click="FindYFromQButton_Click"/>
                                    <TextBlock x:Name="txtReverseResult" 
                                             TextWrapping="Wrap"
                                             Margin="0,10,0,0"
                                             Foreground="DarkGreen"
                                             FontWeight="Bold"/>
                                </StackPanel>
                            </GroupBox>

                            <!-- Calculate Button -->
                            <dx:SimpleButton Content="⚡ CALCULATE" 
                                           Height="50"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           Click="CalculateButton_Click"
                                           Margin="0,0,0,10"/>

                            <!-- Preview -->
                            <views:PreviewPanel x:Name="previewPanel"/>
                        </StackPanel>
                    </ScrollViewer>
                </dxd:LayoutPanel>

                <!-- Right Side -->
                <dxd:LayoutGroup Orientation="Vertical">
                    <!-- Results Panel -->
                    <dxd:LayoutPanel Caption="📊 Results"
                                    ItemHeight="2*"
                                    AllowClose="False">
                        <views:ResultsPanel x:Name="resultsPanel"/>
                    </dxd:LayoutPanel>

                    <!-- Chart Panel -->
                    <dxd:LayoutPanel Caption="📈 Chart"
                                    ItemHeight="1*"
                                    AllowClose="False">
                        <views:ChartPanel x:Name="chartPanel"/>
                    </dxd:LayoutPanel>
                </dxd:LayoutGroup>
            </dxd:LayoutGroup>
        </dxd:DockLayoutManager>
    </DockPanel>
</Window>